(melange.emit
 (runtime_deps ui/index.html ui/src/style.css ui/src/tailwind.css)
 (package executor)
 (promote (until-clean))
 (target lib)
 (libraries executor ui common)
 (module_systems
  (es6 mjs))
 (preprocess
  (pps melange.ppx)))

(rule
 (alias run_post_build)
 (deps
  ; This makes the post-build action dependent on your main executable being built
  ; Replace 'my_executable' with the actual name of your executable
  (file %{target:lib}))
 (action
  ; The command to run after the executable is built
  ; 'system' runs the command in the system shell
  (system "bun build.js")))

(dirs common executor ui \ node_modules)
